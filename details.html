<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>訃聞詳細信息</title>
    <link rel="stylesheet" href="details.css">
</head>
<body>
    <div class="container">
        <div id="obituary-details"></div>
        <div id="flower-basket-section"></div>
    </div>

    <footer class="footer">
        <p>2024祥安生命有限公司 版權所有</p>
        <p>承辦禮儀公司 0938-179-858</p>
        <p>Line ID: your_line_id</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const deceasedName = urlParams.get('deceasedName');
            const deathDate = urlParams.get('deathDate');
            const funeralDate = urlParams.get('funeralDate');
            const funeralLocation = urlParams.get('funeralLocation');
            const hall = urlParams.get('hall');
            const textStyle = urlParams.get('textStyle');
            const sendFlowerBasket = urlParams.get('sendFlowerBasket');

            let obituaryText = '';
            const age = calculateAge(deathDate);

            if (textStyle === 'traditional') {
                obituaryText = `
                    <p>我們摯愛的親人${deceasedName}於${deathDate}逝世，享年${age}歲</p>
                    <p>謹擇於${funeralDate}於${funeralLocation} ${hall}舉行告別儀式，敬邀諸位親友蒞臨告別致意。</p>
                    <p>全體家屬 叩謝</p>
                `;
            } else {
                obituaryText = `
                    <p>我們摯愛的${deceasedName}於${deathDate}辭世，享年${age}歲</p>
                    <p>謹擇於${funeralDate}於${funeralLocation} ${hall}舉行告別儀式，敬邀諸位親友蒞臨告別致意。</p>
                    <p>全體家屬 叩謝</p>
                `;
            }

            document.getElementById('obituary-details').innerHTML = obituaryText;

            if (sendFlowerBasket === 'yes') {
                document.getElementById('flower-basket-section').innerHTML = `
                    <h2>花籃訂購</h2>
                    <form id="flower-basket-form">
                        <label for="basket-type">花籃種類:</label>
                        <select id="basket-type" name="basket-type">
                            <option value="basket1">花籃 1 - NT$2000</option>
                            <option value="basket2">花籃 2 - NT$2500</option>
                            <option value="basket3">花籃 3 - NT$3000</option>
                            <option value="basket4">花籃 4 - NT$3500</option>
                            <option value="basket5">花籃 5 - NT$4000</option>
                            <option value="basket6">花籃 6 - NT$4500</option>
                            <option value="basket7">花籃 7 - NT$5000</option>
                            <option value="basket8">花籃 8 - NT$5500</option>
                        </select>

                        <label for="payment-method">付款方式:</label>
                        <select id="payment-method" name="payment-method">
                            <option value="bank-transfer">銀行匯款</option>
                            <option value="linepay">Line Pay</option>
                        </select>

                        <label for="address">收據/發票地址:</label>
                        <input type="text" id="address" name="address">

                        <button type="submit">訂購花籃</button>
                    </form>
                    <p>匯款單請回傳至 Line ID: your_line_id</p>
                `;
            }
        });

        function calculateAge(deathDate) {
            const birth = new Date(deathDate);
            const today = new Date();
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            return age;
        }
    </script>
</body>
</html>
